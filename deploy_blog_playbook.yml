# deploy-blog.yml (ìˆ˜ì •)
---
- name: Deploy My Blog Application
  hosts: all
  become: yes

  vars:
    # ğŸŸ¢ ì—¬ê¸°ì—ë§Œ 'docker_board_path'ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.
    # {{ playbook_dir }}ì€ í˜„ì¬ í”Œë ˆì´ë¶(deploy-blog.yml)ì´ ìœ„ì¹˜í•œ ë””ë ‰í† ë¦¬ì˜ ì ˆëŒ€ ê²½ë¡œë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.
    docker_board_base_path: "{{ playbook_dir }}/docker-board" # << ë³€ìˆ˜ëª…ë„ í—·ê°ˆë¦¬ì§€ ì•Šê²Œ 'base_path'ë¡œ ë³€ê²½í–ˆìŠµë‹ˆë‹¤.

  tasks:
    - name: Run my_blog_role for web content deployment
      ansible.builtin.include_role:
        name: my_blog_role
      when: inventory_hostname in groups['worker']

    - name: Run docker_swarm_deployer role for stack deployment
      ansible.builtin.include_role:
        name: docker_swarm_deployer
      vars:
        # ğŸŸ¢ ì •ì˜ëœ ë³€ìˆ˜ë¥¼ 'ìƒˆë¡œìš´ ì´ë¦„'ìœ¼ë¡œ 'ê°’'ë§Œ ì „ë‹¬í•©ë‹ˆë‹¤.
        docker_board_path_for_role: "{{ docker_board_base_path }}" # Role ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•  ë³€ìˆ˜ëª…ìœ¼ë¡œ ë§¤í•‘
      when: inventory_hostname in groups['manager'][0]
